README for COAMPS
---------------------------------------------------

Dependencies: 
  - ESMF v7.0.0bs31
  

Build:
  - Set environment variable ESMFMKFILE to point to the esmf.mk of your ESMF installation.
  - gmake [BOPT=<g|O>]
  - Compile time control of model component modules included in driver (COAMPS_Driver.F90) is
    determined by the MKFILE_XYZ_<MOD> (MOD = MED, ATM1, OCN1, WAV1, ICE1, LND1) preprocessor macros.
    XYZ=NLM for non-linear model, XYZ=RPM for representer (tangent-linear) model,
    XYZ=ADM for adjoint model, XYZ=VDA for coupled variational data-assimilation
  

Execution:
  - Optionally set environment variable ESMF_RUNTIME_COMPLIANCECHECK to ON.
  - Optionally set number of processors on command line: NPROC=<nproc>.
    Default nproc is 8.
  - Optionally set name of config file on command line: CONFIG=<config>.
    Default is coamps.rc
  - gmake run [NPROC=<nproc>] [CONFIG=<config>]
  

Output:
  - PET*.Log files containing compliance checker output if turned on.
  - The prototype outputs time stepping information to stdout.


Code structure:
  - Makefile              - Makefile that is based on the standard esmf.mk mechanism
  - COAMPS_AppDriver.F90  - The main coupled application driver for NLM, RPM, and ADM.
  - COAMPS_VdaDriver.F90  - The main coupled application driver for variational data assimilation
  - COAMPS_Driver.F90     - The Driver component, specializing generic NUOPC_Driver
  - COAMPS_Connector.F90  - The Connector component, specializing generic NUOPC_Connector
  - COAMPS_Mediator.F90   - The Mediator component, specializing generic NUOPC_Mediator
  - COAMPS_Mdata.F90      - The Data and Background Model component(s), specializing generic NUOPC_Model
  - COAMPS_Mdumb.F90      - A dummy model component (provides compile time valid SetServices reference)
  - COAMPS_Dutil.F90      - The field dictionary utilities module
  - COAMPS_Futil.F90      - The field & remapping utilities module
  - COAMPS_Gutil.F90      - The grid utilities module
  - COAMPS_Gdem.F90       - The GLOBE DEM database module
  - COAMPS_Gsrumd.F90     - Grid search and remapping utilities (derived from WW3 w3gsrumd.ftn)
  - COAMPS_BkgdIsRqrd.F90 - The "background is required" utility program


ESMF Config input for Driver:

  Note that config input labels for models not included at compile time are silently ignored.

  label                                possible
  (colons required)    type            values        default     description
  ------------------------------------------------------------------------------
  start_time:          integer array                 none        start time of driver
                       [YYYY,MM,DD,hh,mm,ss]                     * required

  run_duration:        integer array                 none        stop time of driver
                       [hh,mm,ss]                                * required

  time_step:           integer array                 none        time step of driver
                       [hh,mm,ss]                                * required

  verbose:             logical         t, f          t           turn on verbose output
                                                                 * optional

  <MOD>_active:        logical         t, f          t           enable/disable <MOD> model
                                                                 * MOD = MED, ATM, OCN, WAV, ICE, LND
                                                                 * optional

  pet_layout_option:   string          sequential    sequential  set the type of PET layout
                                       concurrent                * optional
                                       specified                 * sequential:
                                                                     active models defined on all PETs
                                                                     no other config options required
                                                                 * concurrent:
                                                                     active models defined on non-overlapping sets of PETs
                                                                     requires <MOD>_pet_count input for active models
                                                                     medPetCount optional, default is MED defined on all PETs
                                                                     sum(<MOD>_pet_count) <= petCount
                                                                 * specified:
                                                                     active models defined on specified sets of PETs
                                                                     requires <MOD>_pet_list input for active models
                                                                     medPetList optional, default is MED defined on all PETs

  MED_pet_count:       integer         [1,petCount)  none        number of PETs for MED model
                                                                 * optional when petLayoutOption = concurrent
                                                                   & MED_active = t

  <MOD>_pet_count:     integer         [1,petCount)  none        number of PETs for <MOD> model
                                                                 * MOD = ATM, OCN, WAV, ICE, LND
                                                                 * required when petLayoutOption = concurrent
                                                                   & <MOD>_active = t

  MED_pet_list::       integer table   [0:petCount)  none        PET list for MED model
                                                                 * optional when pet_layout_option = specified
                                                                   & MED_active = t
                                                                 * min(MED_pet_list) >= 0 && max(MED_pet_list) < petCount
                                                                 * table must be terminated with :: on single line

  <MOD>_pet_list::     integer table   [0:petCount)  none        PET list for <MOD> model
                                                                 * MOD = ATM, OCN, WAV, ICE, LND
                                                                 * required when pet_layout_option = specified
                                                                   & <MOD>_active = t
                                                                 * min(<MOD>_pet_list) >= 0 && max(<MOD>_pet_list) < petCount
                                                                 * table must be terminated with :: on single line
